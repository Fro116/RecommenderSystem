# RecommenderSystem
This is an anime recommender system based off of MyAnimeList and AniList user ratings. This codebase has been used to train a model on over 800 million user-item interactions spread across over 5 million users. See the notebook in `notebooks/README.ipynb` for usage instructions (you may need to install Python and JupyterLab first).

Details on the recommender system can be found by inspecting the source code at `notebooks/TrainingAlphas`. There are four main steps:
1. Pretraining a transformer model on watch histories
2. Fine tuning the transformer model on recent data
3. Training a ranking model that uses the outputs of the transformer model to predict a user's preference relation
4. Reranking the outputs of the ranking model to produce a diverse set of recommendations

See [BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding](https://arxiv.org/pdf/1810.04805.pdf), [Deep Neural Networks for YouTube Recommendations](https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/45530.pdf), [Position-Aware ListMLE: A Sequential Learning Process for Ranking](https://auai.org/uai2014/proceedings/individuals/164.pdf), and [Deep Learning for Recommender Systems: A Netflix Case Study](https://ojs.aaai.org/index.php/aimagazine/article/view/18140), for references on some of the methods used. Note that considerable departures from the literature are necessary to create a practical recommender system due to the structure of the input data and the lack of live feedback loops. Particularly interesting problems include 1) learning the balance bewteen exploration and exploitation in a purely offline setting and 2) making full use of bespoke interaction metadata, such as the optionally provided user ratings.

Once the model has been trained, recommendations for a new user can be generated by running `notebooks/RecEgress/RunAllScripts.ipynb`. This will fetch the newest version of a given user's animelist from either MAL or AniList, perform model inference, and output an annotated notebook of the top recommendations for that user.

At some point I'll figure out how frontends work and spin up a website, but until then, the JupyterLab notebook interface will have to do.
