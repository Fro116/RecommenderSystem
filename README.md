# RecommenderSystem
This is an anime and manga recommender system based off of MyAnimeList, AniList, and Kitsu user ratings. This codebase has been used to train a model on over 1.1 billion user-item interactions. See the notebook in `notebooks/README.ipynb` for usage instructions (you may need to install Python and JupyterLab first).

Details on the recommender system can be found by inspecting the source code at `notebooks/TrainingAlphas`. At a high level, there are four main steps:
1. Pretraining a transformer model on watch histories
2. Finetuning the model on recent data
3. Training a ranking model that uses the transformer model (and others) to predict preference relations
4. Reranking the preference relation to optimize for relevance, novelty, and diversity

See [BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding](https://arxiv.org/pdf/1810.04805.pdf), [Deep Neural Networks for YouTube Recommendations](https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/45530.pdf), [Position-Aware ListMLE: A Sequential Learning Process for Ranking](https://auai.org/uai2014/proceedings/individuals/164.pdf), and [Deep Learning for Recommender Systems: A Netflix Case Study](https://ojs.aaai.org/index.php/aimagazine/article/view/18140) for relevant prior work. Much of the difficulty in creating a practical anime/manga recommender system comes from the unusual nature of the input data. Particularly interesting problems include 1) learning the balance bewteen exploration and exploitation in a purely offline setting and 2) optimally using bespoke metadata.

Once the model has been trained, recommendations for a new user can be generated by running `notebooks/RecEgress/RunAllScripts.ipynb`. This will fetch the newest version of a given user's anime and mangs lists from MAL, AniList or Kitsu, perform model inference, and output an annotated notebook of the top recommendations for that user.

At some point I'll figure out how frontends work and spin up a website, but until then, the JupyterLab interface will have to do.
