# RecommenderSystem
This is an anime and manga recommender system based off of MyAnimeList, AniList, Kitsu, and AnimePlanet user ratings. This codebase has been used to train a model on over 1.4 billion user-item interactions. See the notebook in `notebooks/README.ipynb` for usage instructions.

Details on the recommender system can be found by inspecting the source code at `notebooks/TrainingAlphas`. At a high level, there are five main steps:
1. Pretraining a transformer model on watch histories
2. Finetuning the model on recent data
3. Training a learning-to-rank model on preference relations
4. Reranking the outputs to generate a list of recommendations
5. Explaining why the items were recommended

See [BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding](https://arxiv.org/pdf/1810.04805.pdf), [Deep Neural Networks for YouTube Recommendations](https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/45530.pdf), [Position-Aware ListMLE: A Sequential Learning Process for Ranking](https://auai.org/uai2014/proceedings/individuals/164.pdf), [Deep Learning for Recommender Systems: A Netflix Case Study](https://ojs.aaai.org/index.php/aimagazine/article/view/18140), and [A Survey on Trustworthy Recommender Systems](https://arxiv.org/pdf/2207.12515.pdf) for relevant prior work.

Once the system has been trained, recommendations for a new user can be generated by running `notebooks/RecEgress/RunAllScripts.ipynb`. This will fetch the newest version of a given user's anime and manga lists, perform model inference, and output an annotated notebook of the top recommendations for that user.

At some point I'll figure out how frontends work and spin up a website, but until then, the JupyterLab interface will have to do.
